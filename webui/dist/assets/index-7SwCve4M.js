var el=Object.defineProperty;var tl=(e,t,l)=>t in e?el(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;var _t=(e,t,l)=>tl(e,typeof t!="symbol"?t+"":t,l);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function l(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=l(r);fetch(r.href,a)}})();function Z(){}function Ut(e){return e()}function yt(){return Object.create(null)}function Ee(e){e.forEach(Ut)}function gt(e){return typeof e=="function"}function qe(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function ll(e){return Object.keys(e).length===0}function Vt(e,...t){if(e==null){for(const s of t)s(void 0);return Z}const l=e.subscribe(...t);return l.unsubscribe?()=>l.unsubscribe():l}function pt(e,t,l){e.$$.on_destroy.push(Vt(t,l))}function n(e,t){e.appendChild(t)}function U(e,t,l){e.insertBefore(t,l||null)}function H(e){e.parentNode&&e.parentNode.removeChild(e)}function dt(e,t){for(let l=0;l<e.length;l+=1)e[l]&&e[l].d(t)}function u(e){return document.createElement(e)}function E(e){return document.createTextNode(e)}function y(){return E(" ")}function qt(){return E("")}function D(e,t,l,s){return e.addEventListener(t,l,s),()=>e.removeEventListener(t,l,s)}function i(e,t,l){l==null?e.removeAttribute(t):e.getAttribute(t)!==l&&e.setAttribute(t,l)}function sl(e){return Array.from(e.childNodes)}function se(e,t){t=""+t,e.data!==t&&(e.data=t)}function Ft(e,t){e.value=t??""}function ct(e,t,l){for(let s=0;s<e.options.length;s+=1){const r=e.options[s];if(r.__value===t){r.selected=!0;return}}e.selectedIndex=-1}function nl(e,t,{bubbles:l=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:t,bubbles:l,cancelable:s})}let ot;function at(e){ot=e}function zt(){if(!ot)throw new Error("Function called outside component initialization");return ot}function rl(e){zt().$$.on_mount.push(e)}function nt(){const e=zt();return(t,l,{cancelable:s=!1}={})=>{const r=e.$$.callbacks[t];if(r){const a=nl(t,l,{cancelable:s});return r.slice().forEach(o=>{o.call(e,a)}),!a.defaultPrevented}return!0}}const lt=[],kt=[];let st=[];const wt=[],al=Promise.resolve();let mt=!1;function ol(){mt||(mt=!0,al.then(Jt))}function ht(e){st.push(e)}const bt=new Set;let et=0;function Jt(){if(et!==0)return;const e=ot;do{try{for(;et<lt.length;){const t=lt[et];et++,at(t),il(t.$$)}}catch(t){throw lt.length=0,et=0,t}for(at(null),lt.length=0,et=0;kt.length;)kt.pop()();for(let t=0;t<st.length;t+=1){const l=st[t];bt.has(l)||(bt.add(l),l())}st.length=0}while(lt.length);for(;wt.length;)wt.pop()();mt=!1,bt.clear(),at(e)}function il(e){if(e.fragment!==null){e.update(),Ee(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ht)}}function ul(e){const t=[],l=[];st.forEach(s=>e.indexOf(s)===-1?t.push(s):l.push(s)),l.forEach(s=>s()),st=t}const ut=new Set;let Ze;function dl(){Ze={r:0,c:[],p:Ze}}function cl(){Ze.r||Ee(Ze.c),Ze=Ze.p}function Be(e,t){e&&e.i&&(ut.delete(e),e.i(t))}function Ve(e,t,l,s){if(e&&e.o){if(ut.has(e))return;ut.add(e),Ze.c.push(()=>{ut.delete(e),s&&(l&&e.d(1),s())}),e.o(t)}else s&&s()}function We(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ye(e){e&&e.c()}function ze(e,t,l){const{fragment:s,after_update:r}=e.$$;s&&s.m(t,l),ht(()=>{const a=e.$$.on_mount.map(Ut).filter(gt);e.$$.on_destroy?e.$$.on_destroy.push(...a):Ee(a),e.$$.on_mount=[]}),r.forEach(ht)}function Je(e,t){const l=e.$$;l.fragment!==null&&(ul(l.after_update),Ee(l.on_destroy),l.fragment&&l.fragment.d(t),l.on_destroy=l.fragment=null,l.ctx=[])}function fl(e,t){e.$$.dirty[0]===-1&&(lt.push(e),ol(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ge(e,t,l,s,r,a,o=null,f=[-1]){const d=ot;at(e);const c=e.$$={fragment:null,ctx:[],props:a,update:Z,not_equal:r,bound:yt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(d?d.$$.context:[])),callbacks:yt(),dirty:f,skip_bound:!1,root:t.target||d.$$.root};o&&o(c.root);let _=!1;if(c.ctx=l?l(e,t.props||{},(b,h,...w)=>{const g=w.length?w[0]:h;return c.ctx&&r(c.ctx[b],c.ctx[b]=g)&&(!c.skip_bound&&c.bound[b]&&c.bound[b](g),_&&fl(e,b)),h}):[],c.update(),_=!0,Ee(c.before_update),c.fragment=s?s(c.ctx):!1,t.target){if(t.hydrate){const b=sl(t.target);c.fragment&&c.fragment.l(b),b.forEach(H)}else c.fragment&&c.fragment.c();t.intro&&Be(e.$$.fragment),ze(e,t.target,t.anchor),Jt()}at(d)}class Ke{constructor(){_t(this,"$$");_t(this,"$$set")}$destroy(){Je(this,1),this.$destroy=Z}$on(t,l){if(!gt(l))return Z;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(l),()=>{const r=s.indexOf(l);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!ll(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const _l="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_l);function xt(e){let t,l,s,r=(e[4]||"Ready")+"",a,o,f,d=e[5]&&St(e);return{c(){t=u("div"),l=u("div"),s=u("p"),a=E(r),o=y(),d&&d.c(),i(l,"class","flex flex-wrap items-center justify-between gap-2"),i(t,"class",f=`mt-3 rounded-lg border px-3 py-2 text-sm ${e[6]}`)},m(c,_){U(c,t,_),n(t,l),n(l,s),n(s,a),n(l,o),d&&d.m(l,null)},p(c,_){_&16&&r!==(r=(c[4]||"Ready")+"")&&se(a,r),c[5]?d?d.p(c,_):(d=St(c),d.c(),d.m(l,null)):d&&(d.d(1),d=null),_&64&&f!==(f=`mt-3 rounded-lg border px-3 py-2 text-sm ${c[6]}`)&&i(t,"class",f)},d(c){c&&H(t),d&&d.d()}}}function St(e){let t,l,s;return{c(){t=u("p"),l=E("Last Sync: "),s=E(e[5]),i(t,"class","text-xs font-medium uppercase tracking-wide")},m(r,a){U(r,t,a),n(t,l),n(t,s)},p(r,a){a&32&&se(s,r[5])},d(r){r&&H(t)}}}function pl(e){let t,l,s,r,a,o,f=e[3]?"Reloading...":"Reload Server",d,c,_,b=e[2]?"Saving...":"Save to Server",h,w,g,x,v,p,C,k,L,N,M=(e[4]||e[5])&&xt(e);return{c(){t=u("header"),l=u("div"),s=u("div"),s.innerHTML='<p class="text-[11px] font-semibold uppercase tracking-[0.22em] text-slate-500">INTENIQUETIC PRX</p> <h1 class="text-2xl font-black tracking-tight text-ink md:text-3xl">Config Manager</h1>',r=y(),a=u("div"),o=u("button"),d=E(f),c=y(),_=u("button"),h=E(b),w=y(),g=u("button"),g.textContent="Export JSON",x=y(),v=u("label"),p=E(`Import JSON
        `),C=u("input"),k=y(),M&&M.c(),i(o,"class","rounded-lg border border-cyan-300 bg-cyan-50 px-4 py-2 text-sm font-semibold text-cyan-800 hover:bg-cyan-100 disabled:cursor-not-allowed disabled:opacity-60"),o.disabled=e[1],i(_,"class","rounded-lg border border-emerald-300 bg-emerald-50 px-4 py-2 text-sm font-semibold text-emerald-800 hover:bg-emerald-100 disabled:cursor-not-allowed disabled:opacity-60"),_.disabled=e[0],i(g,"class","rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100"),i(C,"class","hidden"),i(C,"type","file"),i(C,"accept","application/json"),i(v,"class","cursor-pointer rounded-lg border border-slate-300 bg-white px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100"),i(a,"class","flex flex-wrap gap-2"),i(l,"class","flex flex-wrap items-center justify-between gap-3"),i(t,"class","sticky top-3 z-20 rounded-2xl border border-white/70 bg-white/75 p-4 shadow-panel backdrop-blur lg:p-5")},m(A,O){U(A,t,O),n(t,l),n(l,s),n(l,r),n(l,a),n(a,o),n(o,d),n(a,c),n(a,_),n(_,h),n(a,w),n(a,g),n(a,x),n(a,v),n(v,p),n(v,C),n(t,k),M&&M.m(t,null),L||(N=[D(o,"click",e[9]),D(_,"click",e[10]),D(g,"click",e[11]),D(C,"change",e[12])],L=!0)},p(A,[O]){O&8&&f!==(f=A[3]?"Reloading...":"Reload Server")&&se(d,f),O&2&&(o.disabled=A[1]),O&4&&b!==(b=A[2]?"Saving...":"Save to Server")&&se(h,b),O&1&&(_.disabled=A[0]),A[4]||A[5]?M?M.p(A,O):(M=xt(A),M.c(),M.m(t,null)):M&&(M.d(1),M=null)},i:Z,o:Z,d(A){A&&H(t),M&&M.d(),L=!1,Ee(N)}}}function bl(e,t,l){let s,{saveDisabled:r=!1}=t,{reloadDisabled:a=!1}=t,{saving:o=!1}=t,{loading:f=!1}=t,{statusMessage:d=""}=t,{statusTone:c="neutral"}=t,{lastSynced:_=""}=t;const b=nt(),h=()=>b("reloadFromServer"),w=()=>b("saveToServer"),g=()=>b("exportJson"),x=v=>b("importJson",v);return e.$$set=v=>{"saveDisabled"in v&&l(0,r=v.saveDisabled),"reloadDisabled"in v&&l(1,a=v.reloadDisabled),"saving"in v&&l(2,o=v.saving),"loading"in v&&l(3,f=v.loading),"statusMessage"in v&&l(4,d=v.statusMessage),"statusTone"in v&&l(8,c=v.statusTone),"lastSynced"in v&&l(5,_=v.lastSynced)},e.$$.update=()=>{e.$$.dirty&256&&l(6,s=c==="ok"?"border-emerald-200 bg-emerald-50 text-emerald-800":c==="error"?"border-rose-200 bg-rose-50 text-rose-800":"border-slate-200 bg-slate-50 text-slate-700")},[r,a,o,f,d,_,s,b,c,h,w,g,x]}class ml extends Ke{constructor(t){super(),Ge(this,t,bl,pl,qe,{saveDisabled:0,reloadDisabled:1,saving:2,loading:3,statusMessage:4,statusTone:8,lastSynced:5})}}function Ct(e,t,l){const s=e.slice();return s[16]=t[l],s}function hl(e){let t,l,s;return{c(){t=u("button"),t.textContent="Edit",i(t,"class","rounded-md border border-aqua/40 bg-aqua/10 px-3 py-1 text-xs font-semibold text-sky-800 hover:bg-aqua/20")},m(r,a){U(r,t,a),l||(s=D(t,"click",e[9]),l=!0)},p:Z,d(r){r&&H(t),l=!1,s()}}}function gl(e){let t,l,s,r,a,o;return{c(){t=u("div"),l=u("button"),l.textContent="Cancel",s=y(),r=u("button"),r.textContent="Save",i(l,"class","rounded-md border border-slate-300 bg-white px-3 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-100"),i(r,"class","rounded-md border border-emerald-300 bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700 hover:bg-emerald-100"),i(t,"class","flex gap-2")},m(f,d){U(f,t,d),n(t,l),n(t,s),n(t,r),a||(o=[D(l,"click",e[10]),D(r,"click",e[11])],a=!0)},p:Z,d(f){f&&H(t),a=!1,Ee(o)}}}function vl(e){let t,l=e[0].log_level+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].log_level+"")&&se(s,l)},d(r){r&&H(t)}}}function yl(e){let t,l,s,r=We(e[8]),a=[];for(let o=0;o<r.length;o+=1)a[o]=Tt(Ct(e,r,o));return{c(){t=u("select");for(let o=0;o<a.length;o+=1)a[o].c();i(t,"class","w-full rounded-lg border border-slate-300 bg-white px-3 py-2")},m(o,f){U(o,t,f);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(t,null);ct(t,e[2]),l||(s=D(t,"change",e[12]),l=!0)},p(o,f){if(f&256){r=We(o[8]);let d;for(d=0;d<r.length;d+=1){const c=Ct(o,r,d);a[d]?a[d].p(c,f):(a[d]=Tt(c),a[d].c(),a[d].m(t,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=r.length}f&260&&ct(t,o[2])},d(o){o&&H(t),dt(a,o),l=!1,s()}}}function Tt(e){let t,l=e[16]+"",s;return{c(){t=u("option"),s=E(l),t.__value=e[16],Ft(t,t.__value)},m(r,a){U(r,t,a),n(t,s)},p:Z,d(r){r&&H(t)}}}function kl(e){let t,l=(e[0].prometheus_listen||"-")+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=(r[0].prometheus_listen||"-")+"")&&se(s,l)},d(r){r&&H(t)}}}function wl(e){let t,l,s;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),t.value=e[3]},m(r,a){U(r,t,a),l||(s=D(t,"input",e[13]),l=!0)},p(r,a){a&8&&t.value!==r[3]&&(t.value=r[3])},d(r){r&&H(t),l=!1,s()}}}function xl(e){let t,l=e[0].access_log?"true":"false",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].access_log?"true":"false")&&se(s,l)},d(r){r&&H(t)}}}function Sl(e){let t,l,s,r,a;return{c(){t=u("label"),l=u("input"),s=E(`
                Enabled`),i(l,"type","checkbox"),l.checked=e[4],i(t,"class","flex items-center gap-2 text-sm text-slate-700")},m(o,f){U(o,t,f),n(t,l),n(t,s),r||(a=D(l,"change",e[14]),r=!0)},p(o,f){f&16&&(l.checked=o[4])},d(o){o&&H(t),r=!1,a()}}}function Cl(e){let t,l,s,r,a,o,f,d,c,_,b,h,w,g,x,v,p,C,k,L,N,M,A,O;function F(q,$){return q[1]?gl:hl}let T=F(e),j=T(e);function z(q,$){return q[1]?yl:vl}let re=z(e),W=re(e);function ce(q,$){return q[1]?wl:kl}let ue=ce(e),K=ue(e);function Y(q,$){return q[1]?Sl:xl}let ae=Y(e),ee=ae(e);return{c(){t=u("article"),l=u("div"),s=u("h2"),s.textContent="Observability",r=y(),j.c(),a=y(),o=u("div"),f=u("table"),d=u("thead"),d.innerHTML='<tr><th class="w-40 px-4 py-3 text-left font-semibold">Key</th> <th class="px-4 py-3 text-left font-semibold">Value</th></tr>',c=y(),_=u("tbody"),b=u("tr"),h=u("td"),h.textContent="log_level",w=y(),g=u("td"),W.c(),x=y(),v=u("tr"),p=u("td"),p.textContent="prometheus_listen",C=y(),k=u("td"),K.c(),L=y(),N=u("tr"),M=u("td"),M.textContent="access_log",A=y(),O=u("td"),ee.c(),i(s,"class","text-base font-bold text-slate-800"),i(l,"class","mb-3 flex items-center justify-between gap-2"),i(d,"class","bg-slate-100 text-slate-700"),i(h,"class","px-4 py-3 font-medium text-slate-800"),i(g,"class","px-4 py-3"),i(p,"class","px-4 py-3 font-medium text-slate-800"),i(k,"class","px-4 py-3"),i(M,"class","px-4 py-3 font-medium text-slate-800"),i(O,"class","px-4 py-3"),i(_,"class","divide-y divide-slate-200"),i(f,"class","min-w-full divide-y divide-slate-200 text-sm"),i(o,"class","overflow-hidden rounded-xl border border-slate-200 bg-white"),i(t,"class","rounded-2xl border border-white/60 bg-white/85 p-4 shadow-panel backdrop-blur")},m(q,$){U(q,t,$),n(t,l),n(l,s),n(l,r),j.m(l,null),n(t,a),n(t,o),n(o,f),n(f,d),n(f,c),n(f,_),n(_,b),n(b,h),n(b,w),n(b,g),W.m(g,null),n(_,x),n(_,v),n(v,p),n(v,C),n(v,k),K.m(k,null),n(_,L),n(_,N),n(N,M),n(N,A),n(N,O),ee.m(O,null)},p(q,[$]){T===(T=F(q))&&j?j.p(q,$):(j.d(1),j=T(q),j&&(j.c(),j.m(l,null))),re===(re=z(q))&&W?W.p(q,$):(W.d(1),W=re(q),W&&(W.c(),W.m(g,null))),ue===(ue=ce(q))&&K?K.p(q,$):(K.d(1),K=ue(q),K&&(K.c(),K.m(k,null))),ae===(ae=Y(q))&&ee?ee.p(q,$):(ee.d(1),ee=ae(q),ee&&(ee.c(),ee.m(O,null)))},i:Z,o:Z,d(q){q&&H(t),j.d(),W.d(),K.d(),ee.d()}}}function Tl(e,t,l){let{observability:s}=t;const r=nt(),a=k=>k.currentTarget.value,o=k=>k.currentTarget.checked,f=k=>k.currentTarget.value,d=["trace","debug","info","warn","error"];let c=!1,_="",b="",h=!1;const w=()=>{l(1,c=!0)},g=()=>{l(1,c=!1)},x=()=>{r("change",{key:"log_level",value:_}),r("change",{key:"prometheus_listen",value:b}),r("change",{key:"access_log",value:h}),l(1,c=!1)},v=k=>l(2,_=f(k)),p=k=>l(3,b=a(k)),C=k=>l(4,h=o(k));return e.$$set=k=>{"observability"in k&&l(0,s=k.observability)},e.$$.update=()=>{e.$$.dirty&3&&(c||(l(2,_=s.log_level),l(3,b=s.prometheus_listen),l(4,h=s.access_log)))},[s,c,_,b,h,a,o,f,d,w,g,x,v,p,C]}class Il extends Ke{constructor(t){super(),Ge(this,t,Tl,Cl,qe,{observability:0})}}const tt=[];function El(e,t){return{subscribe:Qt(e,t).subscribe}}function Qt(e,t=Z){let l;const s=new Set;function r(f){if(qe(e,f)&&(e=f,l)){const d=!tt.length;for(const c of s)c[1](),tt.push(c,e);if(d){for(let c=0;c<tt.length;c+=2)tt[c][0](tt[c+1]);tt.length=0}}}function a(f){r(f(e))}function o(f,d=Z){const c=[f,d];return s.add(c),s.size===1&&(l=t(r,a)||Z),f(e),()=>{s.delete(c),s.size===0&&l&&(l(),l=null)}}return{set:r,update:a,subscribe:o}}function Wt(e,t,l){const s=!Array.isArray(e),r=s?[e]:e;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=t.length<2;return El(l,(o,f)=>{let d=!1;const c=[];let _=0,b=Z;const h=()=>{if(_)return;b();const g=t(s?c[0]:c,o,f);a?o(g):b=gt(g)?g:Z},w=r.map((g,x)=>Vt(g,v=>{c[x]=v,_&=~(1<<x),d&&h()},()=>{_|=1<<x}));return d=!0,h(),function(){Ee(w),b(),d=!1}})}const it=()=>({addr:"127.0.0.1:9000",tls:!1,sni:"localhost",weight:1,verify_cert:null,verify_hostname:null,connect_timeout_ms:null,total_connect_timeout_ms:null,read_timeout_ms:null,write_timeout_ms:null,idle_timeout_ms:null}),Gt=()=>({enabled:!1,consecutive_failures:3,open_ms:3e4}),ft=e=>({name:`route-${e}`,host:"",path_prefix:"/",is_default:e===1,lb:"round_robin",max_retries:0,retry_backoff_ms:0,circuit_breaker:Gt(),upstreams:[it()]}),Kt=()=>({server:{listen:["0.0.0.0:8080"],health_path:"/healthz",ready_path:"/readyz",threads:null,grace_period_seconds:null,graceful_shutdown_timeout_seconds:null,config_reload_debounce_ms:250,tls:null},observability:{log_level:"info",access_log:!0,prometheus_listen:""},routes:[ft(1)]}),Ae=e=>e.replaceAll("\\","\\\\").replaceAll('"','\\"'),$e=e=>e?"true":"false",Rl=e=>`[${e.map(t=>`"${Ae(t)}"`).join(", ")}]`,Qe=(e,t,l)=>{l!==null&&Number.isFinite(l)&&e.push(`${t} = ${Math.max(0,Math.floor(l))}`)},Al=e=>{const t=["[[route.upstream]]"];return t.push(`addr = "${Ae(e.addr)}"`),t.push(`tls = ${$e(e.tls)}`),e.sni.trim()&&t.push(`sni = "${Ae(e.sni)}"`),t.push(`weight = ${Math.min(256,Math.max(1,e.weight))}`),e.verify_cert!==null&&t.push(`verify_cert = ${$e(e.verify_cert)}`),e.verify_hostname!==null&&t.push(`verify_hostname = ${$e(e.verify_hostname)}`),Qe(t,"connect_timeout_ms",e.connect_timeout_ms),Qe(t,"total_connect_timeout_ms",e.total_connect_timeout_ms),Qe(t,"read_timeout_ms",e.read_timeout_ms),Qe(t,"write_timeout_ms",e.write_timeout_ms),Qe(t,"idle_timeout_ms",e.idle_timeout_ms),t.join(`
`)},Ll=e=>{const t=["[[route]]"];t.push(`name = "${Ae(e.name)}"`),e.host.trim()&&t.push(`host = "${Ae(e.host)}"`),t.push(`path_prefix = "${Ae(e.path_prefix||"/")}"`),t.push(`is_default = ${$e(e.is_default)}`),t.push(`lb = "${e.lb}"`),t.push(`max_retries = ${Math.max(0,e.max_retries)}`),t.push(`retry_backoff_ms = ${Math.max(0,e.retry_backoff_ms)}`),t.push(""),t.push("[route.circuit_breaker]"),t.push(`enabled = ${$e(e.circuit_breaker.enabled)}`),t.push(`consecutive_failures = ${Math.max(1,e.circuit_breaker.consecutive_failures)}`),t.push(`open_ms = ${Math.max(1,e.circuit_breaker.open_ms)}`),t.push("");const l=e.upstreams.map(Al).join(`

`);return`${t.join(`
`)}${l}`},Ml=e=>{const t=[];t.push("[server]"),t.push(`listen = ${Rl(e.server.listen.filter(Boolean))}`),t.push(`health_path = "${Ae(e.server.health_path||"/healthz")}"`),t.push(`ready_path = "${Ae(e.server.ready_path||"/readyz")}"`),Qe(t,"threads",e.server.threads),Qe(t,"grace_period_seconds",e.server.grace_period_seconds),Qe(t,"graceful_shutdown_timeout_seconds",e.server.graceful_shutdown_timeout_seconds),t.push(`config_reload_debounce_ms = ${Math.max(0,e.server.config_reload_debounce_ms||0)}`),e.server.tls&&(t.push(""),t.push("[server.tls]"),t.push(`listen = "${Ae(e.server.tls.listen)}"`),t.push(`cert_path = "${Ae(e.server.tls.cert_path)}"`),t.push(`key_path = "${Ae(e.server.tls.key_path)}"`),t.push(`enable_h2 = ${$e(e.server.tls.enable_h2)}`)),t.push(""),t.push("[observability]"),t.push(`log_level = "${Ae(e.observability.log_level||"info")}"`),t.push(`access_log = ${$e(e.observability.access_log)}`),e.observability.prometheus_listen.trim()&&t.push(`prometheus_listen = "${Ae(e.observability.prometheus_listen)}"`);const l=e.routes.map(Ll);return l.length>0&&(t.push(""),t.push(l.join(`

`))),`${t.join(`
`)}
`},Ie=Qt(Kt()),Nl=Wt(Ie,e=>Ml(e)),Ol=Wt(Ie,e=>{const t=[];return e.routes.length===0&&t.push("ต้องมี route อย่างน้อย 1 รายการ"),e.server.health_path.startsWith("/")||t.push("server.health_path ต้องขึ้นต้นด้วย /"),e.server.ready_path.startsWith("/")||t.push("server.ready_path ต้องขึ้นต้นด้วย /"),e.server.health_path===e.server.ready_path&&t.push("server.health_path และ server.ready_path ต้องไม่เหมือนกัน"),e.server.tls&&(e.server.tls.listen.trim()||t.push("server.tls.listen ห้ามว่าง"),e.server.tls.cert_path.trim()||t.push("server.tls.cert_path ห้ามว่าง"),e.server.tls.key_path.trim()||t.push("server.tls.key_path ห้ามว่าง")),e.routes.filter(s=>s.is_default).length>1&&t.push("กำหนด route ที่เป็น default ได้เพียง 1 รายการ"),e.routes.forEach((s,r)=>{s.path_prefix.startsWith("/")||t.push(`Route #${r+1}: path_prefix ต้องขึ้นต้นด้วย /`),s.upstreams.length===0&&t.push(`Route #${r+1}: ต้องมี upstream อย่างน้อย 1 รายการ`),s.circuit_breaker.enabled&&(s.circuit_breaker.consecutive_failures<=0&&t.push(`Route #${r+1}: circuit_breaker.consecutive_failures ต้องมากกว่า 0`),s.circuit_breaker.open_ms<=0&&t.push(`Route #${r+1}: circuit_breaker.open_ms ต้องมากกว่า 0`)),s.upstreams.forEach((a,o)=>{a.addr.trim()||t.push(`Route #${r+1} Upstream #${o+1}: addr ห้ามว่าง`),(a.weight<1||a.weight>256)&&t.push(`Route #${r+1} Upstream #${o+1}: weight ต้องอยู่ในช่วง 1..256`)})}),t}),jl=()=>{Ie.update(e=>(e.routes.push(ft(e.routes.length+1)),e))},Dl=e=>{Ie.update(t=>(t.routes.splice(e,1),t.routes.length===0&&t.routes.push(ft(1)),t))},Pl=e=>{Ie.update(t=>{var l;return(l=t.routes[e])==null||l.upstreams.push(it()),t})},Hl=(e,t)=>{Ie.update(l=>{const s=l.routes[e];return s&&(s.upstreams.splice(t,1),s.upstreams.length===0&&s.upstreams.push(it())),l})};function It(e,t,l){const s=e.slice();return s[36]=t[l],s[38]=l,s}function Et(e,t,l){const s=e.slice();return s[39]=t[l],s}function Rt(e){let t,l=e[39]+"",s;return{c(){t=u("option"),s=E(l),t.__value=e[39],Ft(t,t.__value)},m(r,a){U(r,t,a),n(t,s)},p:Z,d(r){r&&H(t)}}}function At(e){let t,l,s;return{c(){t=u("button"),t.textContent="Add Upstream",i(t,"class","rounded-lg border border-aqua/40 bg-aqua/10 px-3 py-1.5 text-sm font-medium text-sky-800 hover:bg-aqua/20")},m(r,a){U(r,t,a),l||(s=D(t,"click",e[22]),l=!0)},p:Z,d(r){r&&H(t),l=!1,s()}}}function Lt(e){let t,l,s;function r(){return e[23](e[38])}return{c(){t=u("button"),t.textContent="Remove",i(t,"class","rounded-md border border-rose-200 bg-white px-2 py-1 text-xs font-medium text-rose-700 hover:bg-rose-50")},m(a,o){U(a,t,o),l||(s=D(t,"click",r),l=!0)},p(a,o){e=a},d(a){a&&H(t),l=!1,s()}}}function Mt(e){let t,l,s,r,a,o,f,d,c,_,b,h,w,g,x,v,p,C,k,L,N,M,A,O,F,T,j,z,re,W,ce,ue,K,Y,ae,ee,q,$,m,I,J,ie,be,te,xe,R,V,oe,le,Re,ge,fe,Te,pe,he,Fe,ve,ye,de,ke,we,Le,De,Q=!e[3]&&Lt(e);function Pe(...B){return e[24](e[38],...B)}function Ue(...B){return e[25](e[38],...B)}function me(...B){return e[26](e[38],...B)}function Me(...B){return e[27](e[38],...B)}function Oe(...B){return e[28](e[38],...B)}function Se(...B){return e[29](e[38],...B)}function Xe(...B){return e[30](e[38],...B)}function He(...B){return e[31](e[38],...B)}function Ce(...B){return e[32](e[38],...B)}function je(...B){return e[33](e[38],...B)}function _e(...B){return e[34](e[38],...B)}return{c(){t=u("article"),l=u("div"),s=u("span"),s.textContent=`#${e[38]+1}`,r=y(),Q&&Q.c(),a=y(),o=u("div"),f=u("label"),d=E(`Address
            `),c=u("input"),b=y(),h=u("label"),w=E(`SNI
            `),g=u("input"),v=y(),p=u("label"),C=E(`Weight
            `),k=u("input"),N=y(),M=u("label"),A=u("input"),F=E(`
            TLS Enabled`),T=y(),j=u("label"),z=u("input"),W=E(`
            verify_cert`),ce=y(),ue=u("label"),K=u("input"),ae=E(`
            verify_hostname`),ee=y(),q=u("label"),$=E(`connect_timeout_ms
            `),m=u("input"),J=y(),ie=u("label"),be=E(`total_connect_timeout_ms
            `),te=u("input"),R=y(),V=u("label"),oe=E(`read_timeout_ms
            `),le=u("input"),ge=y(),fe=u("label"),Te=E(`write_timeout_ms
            `),pe=u("input"),Fe=y(),ve=u("label"),ye=E(`idle_timeout_ms
            `),de=u("input"),we=y(),i(s,"class","text-sm font-semibold text-slate-700"),i(l,"class","mb-3 flex items-center justify-between"),i(c,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),c.disabled=e[3],c.value=_=e[36].addr,i(f,"class","text-sm text-slate-700"),i(g,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),g.disabled=e[3],g.value=x=e[36].sni,i(h,"class","text-sm text-slate-700"),i(k,"type","number"),i(k,"min","1"),i(k,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),k.disabled=e[3],k.value=L=e[36].weight,i(p,"class","text-sm text-slate-700"),i(A,"type","checkbox"),A.disabled=e[3],A.checked=O=e[36].tls,i(M,"class","mt-7 flex items-center gap-2 text-sm text-slate-700"),i(z,"type","checkbox"),z.disabled=e[3],z.checked=re=e[36].verify_cert??!0,i(j,"class","flex items-center gap-2 text-sm text-slate-700 md:mt-7"),i(K,"type","checkbox"),K.disabled=e[3],K.checked=Y=e[36].verify_hostname??!0,i(ue,"class","flex items-center gap-2 text-sm text-slate-700 md:mt-7"),i(m,"type","number"),i(m,"min","0"),i(m,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),m.disabled=e[3],m.value=I=e[36].connect_timeout_ms??"",i(q,"class","text-sm text-slate-700"),i(te,"type","number"),i(te,"min","0"),i(te,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),te.disabled=e[3],te.value=xe=e[36].total_connect_timeout_ms??"",i(ie,"class","text-sm text-slate-700"),i(le,"type","number"),i(le,"min","0"),i(le,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),le.disabled=e[3],le.value=Re=e[36].read_timeout_ms??"",i(V,"class","text-sm text-slate-700"),i(pe,"type","number"),i(pe,"min","0"),i(pe,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),pe.disabled=e[3],pe.value=he=e[36].write_timeout_ms??"",i(fe,"class","text-sm text-slate-700"),i(de,"type","number"),i(de,"min","0"),i(de,"class","mt-1 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 disabled:bg-slate-100"),de.disabled=e[3],de.value=ke=e[36].idle_timeout_ms??"",i(ve,"class","text-sm text-slate-700"),i(o,"class","grid gap-3 md:grid-cols-2"),i(t,"class","rounded-xl border border-slate-200 bg-slate-50 p-3")},m(B,S){U(B,t,S),n(t,l),n(l,s),n(l,r),Q&&Q.m(l,null),n(t,a),n(t,o),n(o,f),n(f,d),n(f,c),n(o,b),n(o,h),n(h,w),n(h,g),n(o,v),n(o,p),n(p,C),n(p,k),n(o,N),n(o,M),n(M,A),n(M,F),n(o,T),n(o,j),n(j,z),n(j,W),n(o,ce),n(o,ue),n(ue,K),n(ue,ae),n(o,ee),n(o,q),n(q,$),n(q,m),n(o,J),n(o,ie),n(ie,be),n(ie,te),n(o,R),n(o,V),n(V,oe),n(V,le),n(o,ge),n(o,fe),n(fe,Te),n(fe,pe),n(o,Fe),n(o,ve),n(ve,ye),n(ve,de),n(t,we),Le||(De=[D(c,"input",Pe),D(g,"input",Ue),D(k,"input",me),D(A,"change",Me),D(z,"change",Oe),D(K,"change",Se),D(m,"input",Xe),D(te,"input",He),D(le,"input",Ce),D(pe,"input",je),D(de,"input",_e)],Le=!0)},p(B,S){e=B,e[3]?Q&&(Q.d(1),Q=null):Q?Q.p(e,S):(Q=Lt(e),Q.c(),Q.m(l,null)),S[0]&8&&(c.disabled=e[3]),S[0]&17&&_!==(_=e[36].addr)&&c.value!==_&&(c.value=_),S[0]&8&&(g.disabled=e[3]),S[0]&17&&x!==(x=e[36].sni)&&g.value!==x&&(g.value=x),S[0]&8&&(k.disabled=e[3]),S[0]&17&&L!==(L=e[36].weight)&&k.value!==L&&(k.value=L),S[0]&8&&(A.disabled=e[3]),S[0]&17&&O!==(O=e[36].tls)&&(A.checked=O),S[0]&8&&(z.disabled=e[3]),S[0]&17&&re!==(re=e[36].verify_cert??!0)&&(z.checked=re),S[0]&8&&(K.disabled=e[3]),S[0]&17&&Y!==(Y=e[36].verify_hostname??!0)&&(K.checked=Y),S[0]&8&&(m.disabled=e[3]),S[0]&17&&I!==(I=e[36].connect_timeout_ms??"")&&m.value!==I&&(m.value=I),S[0]&8&&(te.disabled=e[3]),S[0]&17&&xe!==(xe=e[36].total_connect_timeout_ms??"")&&te.value!==xe&&(te.value=xe),S[0]&8&&(le.disabled=e[3]),S[0]&17&&Re!==(Re=e[36].read_timeout_ms??"")&&le.value!==Re&&(le.value=Re),S[0]&8&&(pe.disabled=e[3]),S[0]&17&&he!==(he=e[36].write_timeout_ms??"")&&pe.value!==he&&(pe.value=he),S[0]&8&&(de.disabled=e[3]),S[0]&17&&ke!==(ke=e[36].idle_timeout_ms??"")&&de.value!==ke&&(de.value=ke)},d(B){B&&H(t),Q&&Q.d(),Le=!1,Ee(De)}}}function Bl(e){let t,l,s,r,a=e[1]+1+"",o,f,d=e[2].toUpperCase()+"",c,_,b,h,w,g,x,v,p,C,k,L,N,M,A,O,F,T,j,z,re,W,ce,ue,K,Y,ae,ee,q,$,m,I,J,ie,be,te,xe,R,V,oe,le,Re,ge,fe,Te,pe,he,Fe,ve,ye,de,ke,we,Le,De,Q,Pe,Ue,me,Me,Oe,Se,Xe,He,Ce,je=We(e[4]),_e=[];for(let P=0;P<je.length;P+=1)_e[P]=Rt(Et(e,je,P));let B=!e[3]&&At(e),S=We(e[0].upstreams),G=[];for(let P=0;P<S.length;P+=1)G[P]=Mt(It(e,S,P));return{c(){t=u("section"),l=u("div"),s=u("h3"),r=E("Route #"),o=E(a),f=E(" ("),c=E(d),_=E(")"),b=y(),h=u("div"),w=u("label"),g=E(`Name
      `),x=u("input"),p=y(),C=u("label"),k=E(`Host (optional)
      `),L=u("input"),M=y(),A=u("label"),O=E(`Path Prefix
      `),F=u("input"),j=y(),z=u("label"),re=E(`LB Strategy
      `),W=u("select");for(let P=0;P<_e.length;P+=1)_e[P].c();ue=y(),K=u("label"),Y=E(`Max Retries
      `),ae=u("input"),q=y(),$=u("label"),m=E(`Retry Backoff (ms)
      `),I=u("input"),ie=y(),be=u("label"),te=u("input"),R=E(`
    Default Route`),V=y(),oe=u("div"),le=u("h4"),le.textContent="Circuit Breaker",Re=y(),ge=u("div"),fe=u("label"),Te=u("input"),he=E(`
        Enabled`),Fe=y(),ve=u("label"),ye=E(`Consecutive Failures
        `),de=u("input"),we=y(),Le=u("label"),De=E(`Open (ms)
        `),Q=u("input"),Ue=y(),me=u("div"),Me=u("div"),Oe=u("h4"),Oe.textContent="Upstreams",Se=y(),B&&B.c(),Xe=y();for(let P=0;P<G.length;P+=1)G[P].c();i(s,"class","text-lg font-semibold text-ink"),i(l,"class","mb-4 flex items-center justify-between gap-4"),i(x,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),x.disabled=e[3],x.value=v=e[0].name,i(w,"class","text-sm text-slate-700"),i(L,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),L.disabled=e[3],L.value=N=e[0].host,i(C,"class","text-sm text-slate-700"),i(F,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),F.disabled=e[3],F.value=T=e[0].path_prefix,i(A,"class","text-sm text-slate-700"),i(W,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),W.disabled=e[3],i(z,"class","text-sm text-slate-700"),i(ae,"type","number"),i(ae,"min","0"),i(ae,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),ae.disabled=e[3],ae.value=ee=e[0].max_retries,i(K,"class","text-sm text-slate-700"),i(I,"type","number"),i(I,"min","0"),i(I,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),I.disabled=e[3],I.value=J=e[0].retry_backoff_ms,i($,"class","text-sm text-slate-700"),i(h,"class","grid gap-3 md:grid-cols-2"),i(te,"type","checkbox"),te.disabled=e[3],te.checked=xe=e[0].is_default,i(be,"class","mt-3 flex items-center gap-2 text-sm text-slate-700"),i(le,"class","text-sm font-semibold uppercase tracking-wide text-tide"),i(Te,"type","checkbox"),Te.disabled=e[3],Te.checked=pe=e[0].circuit_breaker.enabled,i(fe,"class","flex items-center gap-2 text-sm text-slate-700 md:mt-7"),i(de,"type","number"),i(de,"min","1"),i(de,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),de.disabled=e[3],de.value=ke=e[0].circuit_breaker.consecutive_failures,i(ve,"class","text-sm text-slate-700"),i(Q,"type","number"),i(Q,"min","1"),i(Q,"class","mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 disabled:bg-slate-100"),Q.disabled=e[3],Q.value=Pe=e[0].circuit_breaker.open_ms,i(Le,"class","text-sm text-slate-700"),i(ge,"class","mt-2 grid gap-3 md:grid-cols-3"),i(oe,"class","mt-4 rounded-xl border border-slate-200 bg-slate-50 p-3"),i(Oe,"class","text-sm font-semibold uppercase tracking-wide text-tide"),i(Me,"class","flex items-center justify-between"),i(me,"class","mt-5 space-y-3"),i(t,"class","rounded-2xl bg-white/80 p-5 shadow-panel backdrop-blur")},m(P,ne){U(P,t,ne),n(t,l),n(l,s),n(s,r),n(s,o),n(s,f),n(s,c),n(s,_),n(t,b),n(t,h),n(h,w),n(w,g),n(w,x),n(h,p),n(h,C),n(C,k),n(C,L),n(h,M),n(h,A),n(A,O),n(A,F),n(h,j),n(h,z),n(z,re),n(z,W);for(let X=0;X<_e.length;X+=1)_e[X]&&_e[X].m(W,null);ct(W,e[0].lb),n(h,ue),n(h,K),n(K,Y),n(K,ae),n(h,q),n(h,$),n($,m),n($,I),n(t,ie),n(t,be),n(be,te),n(be,R),n(t,V),n(t,oe),n(oe,le),n(oe,Re),n(oe,ge),n(ge,fe),n(fe,Te),n(fe,he),n(ge,Fe),n(ge,ve),n(ve,ye),n(ve,de),n(ge,we),n(ge,Le),n(Le,De),n(Le,Q),n(t,Ue),n(t,me),n(me,Me),n(Me,Oe),n(Me,Se),B&&B.m(Me,null),n(me,Xe);for(let X=0;X<G.length;X+=1)G[X]&&G[X].m(me,null);He||(Ce=[D(x,"input",e[13]),D(L,"input",e[14]),D(F,"input",e[15]),D(W,"change",e[9]),D(ae,"input",e[16]),D(I,"input",e[17]),D(te,"change",e[18]),D(Te,"change",e[19]),D(de,"input",e[20]),D(Q,"input",e[21])],He=!0)},p(P,ne){if(ne[0]&2&&a!==(a=P[1]+1+"")&&se(o,a),ne[0]&4&&d!==(d=P[2].toUpperCase()+"")&&se(c,d),ne[0]&8&&(x.disabled=P[3]),ne[0]&17&&v!==(v=P[0].name)&&x.value!==v&&(x.value=v),ne[0]&8&&(L.disabled=P[3]),ne[0]&17&&N!==(N=P[0].host)&&L.value!==N&&(L.value=N),ne[0]&8&&(F.disabled=P[3]),ne[0]&17&&T!==(T=P[0].path_prefix)&&F.value!==T&&(F.value=T),ne[0]&16){je=We(P[4]);let X;for(X=0;X<je.length;X+=1){const rt=Et(P,je,X);_e[X]?_e[X].p(rt,ne):(_e[X]=Rt(rt),_e[X].c(),_e[X].m(W,null))}for(;X<_e.length;X+=1)_e[X].d(1);_e.length=je.length}if(ne[0]&8&&(W.disabled=P[3]),ne[0]&17&&ce!==(ce=P[0].lb)&&ct(W,P[0].lb),ne[0]&8&&(ae.disabled=P[3]),ne[0]&17&&ee!==(ee=P[0].max_retries)&&ae.value!==ee&&(ae.value=ee),ne[0]&8&&(I.disabled=P[3]),ne[0]&17&&J!==(J=P[0].retry_backoff_ms)&&I.value!==J&&(I.value=J),ne[0]&8&&(te.disabled=P[3]),ne[0]&17&&xe!==(xe=P[0].is_default)&&(te.checked=xe),ne[0]&8&&(Te.disabled=P[3]),ne[0]&17&&pe!==(pe=P[0].circuit_breaker.enabled)&&(Te.checked=pe),ne[0]&8&&(de.disabled=P[3]),ne[0]&17&&ke!==(ke=P[0].circuit_breaker.consecutive_failures)&&de.value!==ke&&(de.value=ke),ne[0]&8&&(Q.disabled=P[3]),ne[0]&17&&Pe!==(Pe=P[0].circuit_breaker.open_ms)&&Q.value!==Pe&&(Q.value=Pe),P[3]?B&&(B.d(1),B=null):B?B.p(P,ne):(B=At(P),B.c(),B.m(Me,null)),ne[0]&5355){S=We(P[0].upstreams);let X;for(X=0;X<S.length;X+=1){const rt=It(P,S,X);G[X]?G[X].p(rt,ne):(G[X]=Mt(rt),G[X].c(),G[X].m(me,null))}for(;X<G.length;X+=1)G[X].d(1);G.length=S.length}},i:Z,o:Z,d(P){P&&H(t),dt(_e,P),B&&B.d(),dt(G,P),He=!1,Ee(Ce)}}}function Ul(e,t,l){let s,{route:r}=t,{routeIndex:a}=t,{mode:o="edit"}=t;const f=["round_robin","random","hash"],d=m=>m.currentTarget.value,c=(m,I=0)=>Number(m.currentTarget.value||I),_=m=>m.currentTarget.checked,b=m=>m.currentTarget.value,h=(m,I)=>{Ie.update(J=>{const ie=J.routes[a];return ie&&(ie[m]=I),J})},w=m=>{h("lb",b(m))},g=m=>{const I=m.trim();if(!I)return null;const J=Number(I);return Number.isFinite(J)?Math.max(0,Math.floor(J)):null},x=(m,I)=>{Ie.update(J=>{const ie=J.routes[a];return ie&&(m==="enabled"?ie.circuit_breaker.enabled=!!I:m==="consecutive_failures"?ie.circuit_breaker.consecutive_failures=Math.max(1,Number(I)):ie.circuit_breaker.open_ms=Math.max(1,Number(I))),J})},v=(m,I,J)=>{Ie.update(ie=>{var te;const be=(te=ie.routes[a])==null?void 0:te.upstreams[m];return be&&(I==="weight"&&typeof J=="number"?be.weight=Math.min(256,Math.max(1,J)):I==="tls"&&typeof J=="boolean"?be.tls=J:((I==="verify_cert"||I==="verify_hostname")&&typeof J=="boolean"||(I==="connect_timeout_ms"||I==="total_connect_timeout_ms"||I==="read_timeout_ms"||I==="write_timeout_ms"||I==="idle_timeout_ms")&&(typeof J=="number"||J===null)||(I==="addr"||I==="sni")&&typeof J=="string")&&(be[I]=J)),ie})},p=m=>h("name",d(m)),C=m=>h("host",d(m)),k=m=>h("path_prefix",d(m)),L=m=>h("max_retries",c(m)),N=m=>h("retry_backoff_ms",c(m)),M=m=>h("is_default",_(m)),A=m=>x("enabled",_(m)),O=m=>x("consecutive_failures",c(m,1)),F=m=>x("open_ms",c(m,1)),T=()=>Pl(a),j=m=>Hl(a,m),z=(m,I)=>v(m,"addr",d(I)),re=(m,I)=>v(m,"sni",d(I)),W=(m,I)=>v(m,"weight",c(I,1)),ce=(m,I)=>v(m,"tls",_(I)),ue=(m,I)=>v(m,"verify_cert",_(I)),K=(m,I)=>v(m,"verify_hostname",_(I)),Y=(m,I)=>v(m,"connect_timeout_ms",g(d(I))),ae=(m,I)=>v(m,"total_connect_timeout_ms",g(d(I))),ee=(m,I)=>v(m,"read_timeout_ms",g(d(I))),q=(m,I)=>v(m,"write_timeout_ms",g(d(I))),$=(m,I)=>v(m,"idle_timeout_ms",g(d(I)));return e.$$set=m=>{"route"in m&&l(0,r=m.route),"routeIndex"in m&&l(1,a=m.routeIndex),"mode"in m&&l(2,o=m.mode)},e.$$.update=()=>{e.$$.dirty[0]&4&&l(3,s=o==="view")},[r,a,o,s,f,d,c,_,h,w,g,x,v,p,C,k,L,N,M,A,O,F,T,j,z,re,W,ce,ue,K,Y,ae,ee,q,$]}class Vl extends Ke{constructor(t){super(),Ge(this,t,Ul,Bl,qe,{route:0,routeIndex:1,mode:2},null,[-1,-1])}}function Nt(e){let t,l,s;return{c(){t=u("button"),t.textContent="Close",i(t,"class","rounded-md border border-slate-300 bg-white px-2.5 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-100")},m(r,a){U(r,t,a),l||(s=D(t,"click",e[4]),l=!0)},p:Z,d(r){r&&H(t),l=!1,s()}}}function ql(e){let t;return{c(){t=u("div"),t.textContent="Select a route from the table, then click View or Edit.",i(t,"class","rounded-xl border border-dashed border-slate-300 bg-slate-50 px-4 py-10 text-center text-sm text-slate-500")},m(l,s){U(l,t,s)},p:Z,i:Z,o:Z,d(l){l&&H(t)}}}function Fl(e){let t,l;return t=new Vl({props:{route:e[0],routeIndex:e[1],mode:e[2]}}),{c(){Ye(t.$$.fragment)},m(s,r){ze(t,s,r),l=!0},p(s,r){const a={};r&1&&(a.route=s[0]),r&2&&(a.routeIndex=s[1]),r&4&&(a.mode=s[2]),t.$set(a)},i(s){l||(Be(t.$$.fragment,s),l=!0)},o(s){Ve(t.$$.fragment,s),l=!1},d(s){Je(t,s)}}}function zl(e){let t,l,s,r,a,o,f,d,c=e[0]&&Nt(e);const _=[Fl,ql],b=[];function h(w,g){return w[0]?0:1}return o=h(e),f=b[o]=_[o](e),{c(){t=u("article"),l=u("div"),s=u("h2"),s.textContent="Route Detail",r=y(),c&&c.c(),a=y(),f.c(),i(s,"class","text-base font-bold text-slate-800"),i(l,"class","mb-3 flex items-center justify-between"),i(t,"class","rounded-2xl border border-white/60 bg-white/90 p-4 shadow-panel backdrop-blur")},m(w,g){U(w,t,g),n(t,l),n(l,s),n(l,r),c&&c.m(l,null),n(t,a),b[o].m(t,null),d=!0},p(w,[g]){w[0]?c?c.p(w,g):(c=Nt(w),c.c(),c.m(l,null)):c&&(c.d(1),c=null);let x=o;o=h(w),o===x?b[o].p(w,g):(dl(),Ve(b[x],1,1,()=>{b[x]=null}),cl(),f=b[o],f?f.p(w,g):(f=b[o]=_[o](w),f.c()),Be(f,1),f.m(t,null))},i(w){d||(Be(f),d=!0)},o(w){Ve(f),d=!1},d(w){w&&H(t),c&&c.d(),b[o].d()}}}function Jl(e,t,l){let{route:s=null}=t,{routeIndex:r=0}=t,{mode:a="view"}=t;const o=nt(),f=()=>o("close");return e.$$set=d=>{"route"in d&&l(0,s=d.route),"routeIndex"in d&&l(1,r=d.routeIndex),"mode"in d&&l(2,a=d.mode)},[s,r,a,o,f]}class Ql extends Ke{constructor(t){super(),Ge(this,t,Jl,zl,qe,{route:0,routeIndex:1,mode:2})}}function Ot(e,t,l){const s=e.slice();return s[21]=t[l],s}function jt(e){let t,l,s;return{c(){t=u("div"),l=E("Health check failed: "),s=E(e[4]),i(t,"class","mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs font-medium text-rose-700")},m(r,a){U(r,t,a),n(t,l),n(t,s)},p(r,a){a&16&&se(s,r[4])},d(r){r&&H(t)}}}function Wl(e){let t,l=We(e[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Pt(Ot(e,l,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();t=qt()},m(r,a){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(r,a);U(r,t,a)},p(r,a){if(a&38){l=We(r[1]);let o;for(o=0;o<l.length;o+=1){const f=Ot(r,l,o);s[o]?s[o].p(f,a):(s[o]=Pt(f),s[o].c(),s[o].m(t.parentNode,t))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&H(t),dt(s,r)}}}function Gl(e){let t;return{c(){t=u("tr"),t.innerHTML='<td class="px-4 py-6 text-center text-sm text-slate-500" colspan="7">No routes found.</td>'},m(l,s){U(l,t,s)},p:Z,d(l){l&&H(t)}}}function Dt(e){let t;return{c(){t=u("span"),t.textContent="default",i(t,"class","ml-2 rounded-full bg-emerald-100 px-2 py-0.5 text-xs font-semibold text-emerald-700")},m(l,s){U(l,t,s)},d(l){l&&H(t)}}}function Pt(e){let t,l,s=e[21].route.name+"",r,a,o,f,d=(e[21].route.host||"-")+"",c,_,b,h=e[21].route.path_prefix+"",w,g,x,v=e[21].route.lb+"",p,C,k,L=e[21].route.upstreams.length+"",N,M,A,O,F,T,j,z,re,W,ce,ue,K,Y=e[21].route.is_default&&Dt();function ae(){return e[11](e[21])}function ee(){return e[12](e[21])}function q(){return e[13](e[21])}return{c(){t=u("tr"),l=u("td"),r=E(s),a=y(),Y&&Y.c(),o=y(),f=u("td"),c=E(d),_=y(),b=u("td"),w=E(h),g=y(),x=u("td"),p=E(v),C=y(),k=u("td"),N=E(L),M=y(),A=u("td"),O=u("div"),F=u("button"),F.textContent="View",T=y(),j=u("button"),j.textContent="Edit",z=y(),re=u("button"),re.textContent="Delete",W=y(),i(l,"class","px-4 py-3 font-medium text-slate-900"),i(f,"class","px-4 py-3 text-slate-700"),i(b,"class","px-4 py-3 text-slate-700"),i(x,"class","px-4 py-3 text-slate-700"),i(k,"class","px-4 py-3 text-slate-700"),i(F,"class","rounded-md border border-slate-300 bg-white px-2.5 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-100"),i(j,"class","rounded-md border border-aqua/40 bg-aqua/10 px-2.5 py-1 text-xs font-semibold text-sky-800 hover:bg-aqua/20"),i(re,"class","rounded-md border border-rose-200 bg-rose-50 px-2.5 py-1 text-xs font-semibold text-rose-700 hover:bg-rose-100"),i(O,"class","flex flex-wrap gap-2"),i(A,"class","px-4 py-3"),i(t,"class",ce=e[2]===e[21].route.route_index?"bg-cyan-50/70":"hover:bg-slate-50")},m($,m){U($,t,m),n(t,l),n(l,r),n(l,a),Y&&Y.m(l,null),n(t,o),n(t,f),n(f,c),n(t,_),n(t,b),n(b,w),n(t,g),n(t,x),n(x,p),n(t,C),n(t,k),n(k,N),n(t,M),n(t,A),n(A,O),n(O,F),n(O,T),n(O,j),n(O,z),n(O,re),n(t,W),ue||(K=[D(F,"click",ae),D(j,"click",ee),D(re,"click",q)],ue=!0)},p($,m){e=$,m&2&&s!==(s=e[21].route.name+"")&&se(r,s),e[21].route.is_default?Y||(Y=Dt(),Y.c(),Y.m(l,null)):Y&&(Y.d(1),Y=null),m&2&&d!==(d=(e[21].route.host||"-")+"")&&se(c,d),m&2&&h!==(h=e[21].route.path_prefix+"")&&se(w,h),m&2&&v!==(v=e[21].route.lb+"")&&se(p,v),m&2&&L!==(L=e[21].route.upstreams.length+"")&&se(N,L),m&6&&ce!==(ce=e[2]===e[21].route.route_index?"bg-cyan-50/70":"hover:bg-slate-50")&&i(t,"class",ce)},d($){$&&H(t),Y&&Y.d(),ue=!1,Ee(K)}}}function Kl(e){let t,l,s,r,a,o,f,d,c,_,b=e[3]?"Checking...":"Check Health",h,w,g,x,v,p,C,k,L,N,M,A=e[4]&&jt(e);function O(j,z){return j[1].length===0?Gl:Wl}let F=O(e),T=F(e);return{c(){t=u("article"),l=u("div"),s=u("h2"),s.textContent="Routes",r=y(),a=u("div"),o=u("input"),f=y(),d=u("button"),d.textContent="Add Route",c=y(),_=u("button"),h=E(b),w=y(),A&&A.c(),g=y(),x=u("div"),v=u("div"),p=u("table"),C=u("thead"),C.innerHTML='<tr><th class="px-4 py-3 text-left font-semibold">Route</th> <th class="px-4 py-3 text-left font-semibold">Host</th> <th class="px-4 py-3 text-left font-semibold">Path</th> <th class="px-4 py-3 text-left font-semibold">LB</th> <th class="px-4 py-3 text-left font-semibold">Upstreams</th> <th class="px-4 py-3 text-left font-semibold">Actions</th></tr>',k=y(),L=u("tbody"),T.c(),i(s,"class","text-base font-bold text-slate-800"),i(o,"class","w-full rounded-lg border border-slate-300 px-3 py-2 text-sm md:w-72"),i(o,"placeholder","Search route name / host / path / strategy"),o.value=e[0],i(d,"class","rounded-md border border-aqua/40 bg-aqua/10 px-3 py-2 text-xs font-semibold text-sky-800 hover:bg-aqua/20"),i(_,"class","rounded-md border border-emerald-300/70 bg-emerald-50 px-3 py-2 text-xs font-semibold text-emerald-800 hover:bg-emerald-100 disabled:cursor-not-allowed disabled:opacity-60"),_.disabled=e[3],i(a,"class","flex w-full items-center gap-2 md:w-auto"),i(l,"class","mb-3 flex flex-wrap items-center justify-between gap-2"),i(C,"class","sticky top-0 z-10 bg-slate-100 text-slate-700"),i(L,"class","divide-y divide-slate-200"),i(p,"class","min-w-full divide-y divide-slate-200 text-sm"),i(v,"class","max-h-[46vh] overflow-auto"),i(x,"class","overflow-hidden rounded-xl border border-slate-200 bg-white"),i(t,"class","rounded-2xl border border-white/60 bg-white/85 p-4 shadow-panel backdrop-blur")},m(j,z){U(j,t,z),n(t,l),n(l,s),n(l,r),n(l,a),n(a,o),n(a,f),n(a,d),n(a,c),n(a,_),n(_,h),n(t,w),A&&A.m(t,null),n(t,g),n(t,x),n(x,v),n(v,p),n(p,C),n(p,k),n(p,L),T.m(L,null),N||(M=[D(o,"input",e[8]),D(d,"click",e[9]),D(_,"click",e[10])],N=!0)},p(j,[z]){z&1&&o.value!==j[0]&&(o.value=j[0]),z&8&&b!==(b=j[3]?"Checking...":"Check Health")&&se(h,b),z&8&&(_.disabled=j[3]),j[4]?A?A.p(j,z):(A=jt(j),A.c(),A.m(t,g)):A&&(A.d(1),A=null),F===(F=O(j))&&T?T.p(j,z):(T.d(1),T=F(j),T&&(T.c(),T.m(L,null)))},i:Z,o:Z,d(j){j&&H(t),A&&A.d(),T.d(),N=!1,Ee(M)}}}function Xl(e,t,l){let{routeQuery:s=""}=t,{rows:r=[]}=t,{selectedRouteIndex:a=null}=t,{routeHealthByIndex:o={}}=t,{healthLoading:f=!1}=t,{healthError:d=""}=t;const c=nt(),_=p=>p.currentTarget.value,b=p=>c("search",_(p)),h=()=>c("addRoute"),w=()=>c("refreshHealth"),g=p=>c("view",p.route.route_index),x=p=>c("edit",p.route.route_index),v=p=>c("delete",p.route.route_index);return e.$$set=p=>{"routeQuery"in p&&l(0,s=p.routeQuery),"rows"in p&&l(1,r=p.rows),"selectedRouteIndex"in p&&l(2,a=p.selectedRouteIndex),"routeHealthByIndex"in p&&l(7,o=p.routeHealthByIndex),"healthLoading"in p&&l(3,f=p.healthLoading),"healthError"in p&&l(4,d=p.healthError)},[s,r,a,f,d,c,_,o,b,h,w,g,x,v]}class Yl extends Ke{constructor(t){super(),Ge(this,t,Xl,Kl,qe,{routeQuery:0,rows:1,selectedRouteIndex:2,routeHealthByIndex:7,healthLoading:3,healthError:4})}}function Zl(e){let t,l,s;return{c(){t=u("button"),t.textContent="Edit",i(t,"class","rounded-md border border-aqua/40 bg-aqua/10 px-3 py-1 text-xs font-semibold text-sky-800 hover:bg-aqua/20")},m(r,a){U(r,t,a),l||(s=D(t,"click",e[5]),l=!0)},p:Z,d(r){r&&H(t),l=!1,s()}}}function $l(e){let t,l,s,r,a,o;return{c(){t=u("div"),l=u("button"),l.textContent="Cancel",s=y(),r=u("button"),r.textContent="Save",i(l,"class","rounded-md border border-slate-300 bg-white px-3 py-1 text-xs font-semibold text-slate-700 hover:bg-slate-100"),i(r,"class","rounded-md border border-emerald-300 bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700 hover:bg-emerald-100"),i(t,"class","flex gap-2")},m(f,d){U(f,t,d),n(t,l),n(t,s),n(t,r),a||(o=[D(l,"click",e[6]),D(r,"click",e[8])],a=!0)},p:Z,d(f){f&&H(t),a=!1,Ee(o)}}}function es(e){let t,l=e[0].listen.join(", ")+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].listen.join(", ")+"")&&se(s,l)},d(r){r&&H(t)}}}function ts(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),t.value=l=e[2].listen.join(", ")},m(a,o){U(a,t,o),s||(r=D(t,"input",e[9]),s=!0)},p(a,o){o&4&&l!==(l=a[2].listen.join(", "))&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function ls(e){let t,l=e[0].health_path+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].health_path+"")&&se(s,l)},d(r){r&&H(t)}}}function ss(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),t.value=l=e[2].health_path},m(a,o){U(a,t,o),s||(r=D(t,"input",e[10]),s=!0)},p(a,o){o&4&&l!==(l=a[2].health_path)&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function ns(e){let t,l=e[0].ready_path+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].ready_path+"")&&se(s,l)},d(r){r&&H(t)}}}function rs(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),t.value=l=e[2].ready_path},m(a,o){U(a,t,o),s||(r=D(t,"input",e[11]),s=!0)},p(a,o){o&4&&l!==(l=a[2].ready_path)&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function as(e){let t,l=(e[0].threads??"-")+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=(r[0].threads??"-")+"")&&se(s,l)},d(r){r&&H(t)}}}function os(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),i(t,"placeholder","null"),t.value=l=e[2].threads??""},m(a,o){U(a,t,o),s||(r=D(t,"input",e[12]),s=!0)},p(a,o){o&4&&l!==(l=a[2].threads??"")&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function is(e){let t,l=(e[0].grace_period_seconds??"-")+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=(r[0].grace_period_seconds??"-")+"")&&se(s,l)},d(r){r&&H(t)}}}function us(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),i(t,"placeholder","null"),t.value=l=e[2].grace_period_seconds??""},m(a,o){U(a,t,o),s||(r=D(t,"input",e[13]),s=!0)},p(a,o){o&4&&l!==(l=a[2].grace_period_seconds??"")&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function ds(e){let t,l=(e[0].graceful_shutdown_timeout_seconds??"-")+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=(r[0].graceful_shutdown_timeout_seconds??"-")+"")&&se(s,l)},d(r){r&&H(t)}}}function cs(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),i(t,"placeholder","null"),t.value=l=e[2].graceful_shutdown_timeout_seconds??""},m(a,o){U(a,t,o),s||(r=D(t,"input",e[14]),s=!0)},p(a,o){o&4&&l!==(l=a[2].graceful_shutdown_timeout_seconds??"")&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function fs(e){let t,l=e[0].config_reload_debounce_ms+"",s;return{c(){t=u("span"),s=E(l),i(t,"class","text-slate-700")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&1&&l!==(l=r[0].config_reload_debounce_ms+"")&&se(s,l)},d(r){r&&H(t)}}}function _s(e){let t,l,s,r;return{c(){t=u("input"),i(t,"class","w-full rounded-lg border border-slate-300 px-3 py-2"),t.value=l=e[2].config_reload_debounce_ms},m(a,o){U(a,t,o),s||(r=D(t,"input",e[15]),s=!0)},p(a,o){o&4&&l!==(l=a[2].config_reload_debounce_ms)&&t.value!==l&&(t.value=l)},d(a){a&&H(t),s=!1,r()}}}function ps(e){let t;return{c(){t=u("span"),t.textContent="disabled",i(t,"class","text-slate-700")},m(l,s){U(l,t,s)},p:Z,d(l){l&&H(t)}}}function bs(e){let t,l,s,r=e[0].tls.listen+"",a,o,f,d,c=e[0].tls.cert_path+"",_,b,h,w,g=e[0].tls.key_path+"",x,v,p,C,k=e[0].tls.enable_h2?"true":"false",L;return{c(){t=u("div"),l=u("div"),s=E("listen: "),a=E(r),o=y(),f=u("div"),d=E("cert_path: "),_=E(c),b=y(),h=u("div"),w=E("key_path: "),x=E(g),v=y(),p=u("div"),C=E("enable_h2: "),L=E(k),i(t,"class","space-y-1 text-slate-700")},m(N,M){U(N,t,M),n(t,l),n(l,s),n(l,a),n(t,o),n(t,f),n(f,d),n(f,_),n(t,b),n(t,h),n(h,w),n(h,x),n(t,v),n(t,p),n(p,C),n(p,L)},p(N,M){M&1&&r!==(r=N[0].tls.listen+"")&&se(a,r),M&1&&c!==(c=N[0].tls.cert_path+"")&&se(_,c),M&1&&g!==(g=N[0].tls.key_path+"")&&se(x,g),M&1&&k!==(k=N[0].tls.enable_h2?"true":"false")&&se(L,k)},d(N){N&&H(t)}}}function ms(e){let t,l,s,r,a,o,f,d,c=e[2].tls&&Ht(e);return{c(){t=u("label"),l=u("input"),r=E(`
                Enable TLS`),a=y(),c&&c.c(),o=qt(),i(l,"type","checkbox"),l.checked=s=e[2].tls!==null,i(t,"class","mb-2 flex items-center gap-2 text-sm text-slate-700")},m(_,b){U(_,t,b),n(t,l),n(t,r),U(_,a,b),c&&c.m(_,b),U(_,o,b),f||(d=D(l,"change",e[16]),f=!0)},p(_,b){b&4&&s!==(s=_[2].tls!==null)&&(l.checked=s),_[2].tls?c?c.p(_,b):(c=Ht(_),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(_){_&&(H(t),H(a),H(o)),c&&c.d(_),f=!1,d()}}}function Ht(e){let t,l,s,r,a,o,f,d,c,_,b,h,w,g,x,v;return{c(){t=u("div"),l=u("input"),r=y(),a=u("label"),o=u("input"),d=E(`
                    enable_h2`),c=y(),_=u("input"),h=y(),w=u("input"),i(l,"class","rounded-lg border border-slate-300 px-3 py-2"),i(l,"placeholder","listen"),l.value=s=e[2].tls.listen,i(o,"type","checkbox"),o.checked=f=e[2].tls.enable_h2,i(a,"class","mt-2 flex items-center gap-2 text-sm text-slate-700"),i(_,"class","rounded-lg border border-slate-300 px-3 py-2 md:col-span-2"),i(_,"placeholder","cert_path"),_.value=b=e[2].tls.cert_path,i(w,"class","rounded-lg border border-slate-300 px-3 py-2 md:col-span-2"),i(w,"placeholder","key_path"),w.value=g=e[2].tls.key_path,i(t,"class","grid gap-2 md:grid-cols-2")},m(p,C){U(p,t,C),n(t,l),n(t,r),n(t,a),n(a,o),n(a,d),n(t,c),n(t,_),n(t,h),n(t,w),x||(v=[D(l,"input",e[17]),D(o,"change",e[18]),D(_,"input",e[19]),D(w,"input",e[20])],x=!0)},p(p,C){C&4&&s!==(s=p[2].tls.listen)&&l.value!==s&&(l.value=s),C&4&&f!==(f=p[2].tls.enable_h2)&&(o.checked=f),C&4&&b!==(b=p[2].tls.cert_path)&&_.value!==b&&(_.value=b),C&4&&g!==(g=p[2].tls.key_path)&&w.value!==g&&(w.value=g)},d(p){p&&H(t),x=!1,Ee(v)}}}function hs(e){let t,l,s,r,a,o,f,d,c,_,b,h,w,g,x,v,p,C,k,L,N,M,A,O,F,T,j,z,re,W,ce,ue,K,Y,ae,ee,q,$,m,I,J,ie,be,te,xe,R,V,oe,le;function Re(S,G){return S[1]?$l:Zl}let ge=Re(e),fe=ge(e);function Te(S,G){return S[1]?ts:es}let pe=Te(e),he=pe(e);function Fe(S,G){return S[1]?ss:ls}let ve=Fe(e),ye=ve(e);function de(S,G){return S[1]?rs:ns}let ke=de(e),we=ke(e);function Le(S,G){return S[1]?os:as}let De=Le(e),Q=De(e);function Pe(S,G){return S[1]?us:is}let Ue=Pe(e),me=Ue(e);function Me(S,G){return S[1]?cs:ds}let Oe=Me(e),Se=Oe(e);function Xe(S,G){return S[1]?_s:fs}let He=Xe(e),Ce=He(e);function je(S,G){return S[1]?ms:S[0].tls?bs:ps}let _e=je(e),B=_e(e);return{c(){t=u("article"),l=u("div"),s=u("h2"),s.textContent="Server",r=y(),fe.c(),a=y(),o=u("div"),f=u("table"),d=u("thead"),d.innerHTML='<tr><th class="w-52 px-4 py-3 text-left font-semibold">Key</th> <th class="px-4 py-3 text-left font-semibold">Value</th></tr>',c=y(),_=u("tbody"),b=u("tr"),h=u("td"),h.textContent="listen",w=y(),g=u("td"),he.c(),x=y(),v=u("tr"),p=u("td"),p.textContent="health_path",C=y(),k=u("td"),ye.c(),L=y(),N=u("tr"),M=u("td"),M.textContent="ready_path",A=y(),O=u("td"),we.c(),F=y(),T=u("tr"),j=u("td"),j.textContent="threads",z=y(),re=u("td"),Q.c(),W=y(),ce=u("tr"),ue=u("td"),ue.textContent="grace_period_seconds",K=y(),Y=u("td"),me.c(),ae=y(),ee=u("tr"),q=u("td"),q.textContent="graceful_shutdown_timeout_seconds",$=y(),m=u("td"),Se.c(),I=y(),J=u("tr"),ie=u("td"),ie.textContent="config_reload_debounce_ms",be=y(),te=u("td"),Ce.c(),xe=y(),R=u("tr"),V=u("td"),V.textContent="server.tls",oe=y(),le=u("td"),B.c(),i(s,"class","text-base font-bold text-slate-800"),i(l,"class","mb-3 flex items-center justify-between gap-2"),i(d,"class","bg-slate-100 text-slate-700"),i(h,"class","px-4 py-3 font-medium text-slate-800"),i(g,"class","px-4 py-3"),i(p,"class","px-4 py-3 font-medium text-slate-800"),i(k,"class","px-4 py-3"),i(M,"class","px-4 py-3 font-medium text-slate-800"),i(O,"class","px-4 py-3"),i(j,"class","px-4 py-3 font-medium text-slate-800"),i(re,"class","px-4 py-3"),i(ue,"class","px-4 py-3 font-medium text-slate-800"),i(Y,"class","px-4 py-3"),i(q,"class","px-4 py-3 font-medium text-slate-800"),i(m,"class","px-4 py-3"),i(ie,"class","px-4 py-3 font-medium text-slate-800"),i(te,"class","px-4 py-3"),i(V,"class","px-4 py-3 font-medium text-slate-800 align-top"),i(le,"class","px-4 py-3"),i(_,"class","divide-y divide-slate-200"),i(f,"class","min-w-full divide-y divide-slate-200 text-sm"),i(o,"class","overflow-hidden rounded-xl border border-slate-200 bg-white"),i(t,"class","rounded-2xl border border-white/60 bg-white/85 p-4 shadow-panel backdrop-blur")},m(S,G){U(S,t,G),n(t,l),n(l,s),n(l,r),fe.m(l,null),n(t,a),n(t,o),n(o,f),n(f,d),n(f,c),n(f,_),n(_,b),n(b,h),n(b,w),n(b,g),he.m(g,null),n(_,x),n(_,v),n(v,p),n(v,C),n(v,k),ye.m(k,null),n(_,L),n(_,N),n(N,M),n(N,A),n(N,O),we.m(O,null),n(_,F),n(_,T),n(T,j),n(T,z),n(T,re),Q.m(re,null),n(_,W),n(_,ce),n(ce,ue),n(ce,K),n(ce,Y),me.m(Y,null),n(_,ae),n(_,ee),n(ee,q),n(ee,$),n(ee,m),Se.m(m,null),n(_,I),n(_,J),n(J,ie),n(J,be),n(J,te),Ce.m(te,null),n(_,xe),n(_,R),n(R,V),n(R,oe),n(R,le),B.m(le,null)},p(S,[G]){ge===(ge=Re(S))&&fe?fe.p(S,G):(fe.d(1),fe=ge(S),fe&&(fe.c(),fe.m(l,null))),pe===(pe=Te(S))&&he?he.p(S,G):(he.d(1),he=pe(S),he&&(he.c(),he.m(g,null))),ve===(ve=Fe(S))&&ye?ye.p(S,G):(ye.d(1),ye=ve(S),ye&&(ye.c(),ye.m(k,null))),ke===(ke=de(S))&&we?we.p(S,G):(we.d(1),we=ke(S),we&&(we.c(),we.m(O,null))),De===(De=Le(S))&&Q?Q.p(S,G):(Q.d(1),Q=De(S),Q&&(Q.c(),Q.m(re,null))),Ue===(Ue=Pe(S))&&me?me.p(S,G):(me.d(1),me=Ue(S),me&&(me.c(),me.m(Y,null))),Oe===(Oe=Me(S))&&Se?Se.p(S,G):(Se.d(1),Se=Oe(S),Se&&(Se.c(),Se.m(m,null))),He===(He=Xe(S))&&Ce?Ce.p(S,G):(Ce.d(1),Ce=He(S),Ce&&(Ce.c(),Ce.m(te,null))),_e===(_e=je(S))&&B?B.p(S,G):(B.d(1),B=_e(S),B&&(B.c(),B.m(le,null)))},i:Z,o:Z,d(S){S&&H(t),fe.d(),he.d(),ye.d(),we.d(),Q.d(),me.d(),Se.d(),Ce.d(),B.d()}}}function gs(e,t,l){let{server:s}=t;const r=nt(),a=T=>T.currentTarget.value,o=T=>T.currentTarget.checked;let f=!1,d={listen:["0.0.0.0:8080"],health_path:"/healthz",ready_path:"/readyz",threads:null,grace_period_seconds:null,graceful_shutdown_timeout_seconds:null,config_reload_debounce_ms:250,tls:null};const c=T=>({...T,listen:[...T.listen],tls:T.tls?{...T.tls}:null}),_=()=>{l(2,d=c(s)),l(1,f=!0)},b=()=>{l(1,f=!1)},h=T=>{const j=T.trim();if(!j)return null;const z=Number(j);return Number.isFinite(z)?Math.max(0,Math.floor(z)):null},w=()=>{l(2,d.listen=d.listen.map(T=>T.trim()).filter(Boolean),d),d.listen.length===0&&l(2,d.listen=["0.0.0.0:8080"],d),d.tls&&(l(2,d.tls.listen=d.tls.listen.trim(),d),l(2,d.tls.cert_path=d.tls.cert_path.trim(),d),l(2,d.tls.key_path=d.tls.key_path.trim(),d)),r("save",c(d)),l(1,f=!1)},g=T=>l(2,d.listen=a(T).split(",").map(j=>j.trim()).filter(Boolean),d),x=T=>l(2,d.health_path=a(T),d),v=T=>l(2,d.ready_path=a(T),d),p=T=>l(2,d.threads=h(a(T)),d),C=T=>l(2,d.grace_period_seconds=h(a(T)),d),k=T=>l(2,d.graceful_shutdown_timeout_seconds=h(a(T)),d),L=T=>l(2,d.config_reload_debounce_ms=h(a(T))??0,d),N=T=>l(2,d.tls=o(T)?{listen:"0.0.0.0:8443",cert_path:"",key_path:"",enable_h2:!0}:null,d),M=T=>d.tls&&l(2,d.tls.listen=a(T),d),A=T=>d.tls&&l(2,d.tls.enable_h2=o(T),d),O=T=>d.tls&&l(2,d.tls.cert_path=a(T),d),F=T=>d.tls&&l(2,d.tls.key_path=a(T),d);return e.$$set=T=>{"server"in T&&l(0,s=T.server)},e.$$.update=()=>{e.$$.dirty&3&&(f||l(2,d=c(s)))},[s,f,d,a,o,_,b,h,w,g,x,v,p,C,k,L,N,M,A,O,F]}class vs extends Ke{constructor(t){super(),Ge(this,t,gs,hs,qe,{server:0})}}function Bt(e){let t,l=e[2][0]+"",s;return{c(){t=u("div"),s=E(l),i(t,"class","mb-3 rounded-lg border border-rose-300/30 bg-rose-400/10 p-3 text-xs text-rose-100")},m(r,a){U(r,t,a),n(t,s)},p(r,a){a&4&&l!==(l=r[2][0]+"")&&se(s,l)},d(r){r&&H(t)}}}function ys(e){let t,l,s,r,a,o=e[1]?"Copied":"Copy",f,d,c,_=e[3]?"VALIDATION: PASS":`VALIDATION: FAIL (${e[2].length} issue(s))`,b,h,w,g,x,v,p,C,k=!e[3]&&Bt(e);return{c(){t=u("article"),l=u("div"),s=u("h2"),s.textContent="TOML Preview",r=y(),a=u("button"),f=E(o),d=y(),c=u("div"),b=E(_),w=y(),k&&k.c(),g=y(),x=u("pre"),v=E(e[0]),i(s,"class","text-base font-bold"),i(a,"class","rounded-lg border border-cyan-300/40 bg-cyan-300/10 px-3 py-1.5 text-sm font-semibold text-cyan-100 hover:bg-cyan-300/20"),i(l,"class","mb-3 flex flex-wrap items-center justify-between gap-3"),i(c,"class",h=e[3]?"mb-3 w-full rounded-lg border border-emerald-300/40 bg-emerald-400/15 px-3 py-2 text-sm font-semibold text-emerald-200":"mb-3 w-full rounded-lg border border-rose-300/40 bg-rose-400/15 px-3 py-2 text-sm font-semibold text-rose-200"),i(x,"class","max-h-[36vh] overflow-auto rounded-xl bg-black/30 p-4 text-xs leading-6 md:text-sm"),i(t,"class","rounded-2xl border border-white/60 bg-[#0f172a] p-4 text-slate-100 shadow-panel")},m(L,N){U(L,t,N),n(t,l),n(l,s),n(l,r),n(l,a),n(a,f),n(t,d),n(t,c),n(c,b),n(t,w),k&&k.m(t,null),n(t,g),n(t,x),n(x,v),p||(C=D(a,"click",e[5]),p=!0)},p(L,[N]){N&2&&o!==(o=L[1]?"Copied":"Copy")&&se(f,o),N&12&&_!==(_=L[3]?"VALIDATION: PASS":`VALIDATION: FAIL (${L[2].length} issue(s))`)&&se(b,_),N&8&&h!==(h=L[3]?"mb-3 w-full rounded-lg border border-emerald-300/40 bg-emerald-400/15 px-3 py-2 text-sm font-semibold text-emerald-200":"mb-3 w-full rounded-lg border border-rose-300/40 bg-rose-400/15 px-3 py-2 text-sm font-semibold text-rose-200")&&i(c,"class",h),L[3]?k&&(k.d(1),k=null):k?k.p(L,N):(k=Bt(L),k.c(),k.m(t,g)),N&1&&se(v,L[0])},i:Z,o:Z,d(L){L&&H(t),k&&k.d(),p=!1,C()}}}function ks(e,t,l){let s,{toml:r=""}=t,{copied:a=!1}=t,{issues:o=[]}=t;const f=nt(),d=()=>f("copy");return e.$$set=c=>{"toml"in c&&l(0,r=c.toml),"copied"in c&&l(1,a=c.copied),"issues"in c&&l(2,o=c.issues)},e.$$.update=()=>{e.$$.dirty&4&&l(3,s=o.length===0)},[r,a,o,s,f,d]}class ws extends Ke{constructor(t){super(),Ge(this,t,ks,ys,qe,{toml:0,copied:1,issues:2})}}const Ne=e=>{if(e==null||e==="")return null;const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.floor(t)):null},xs=e=>e==="random"||e==="hash"||e==="round_robin"?e:"round_robin",Ss=e=>{const t=it(),l=Ne(e.weight)??t.weight;return{...t,...e,addr:String(e.addr??t.addr),tls:e.tls??t.tls,sni:e.sni==null?"":String(e.sni),weight:Math.max(1,Math.min(256,l)),verify_cert:typeof e.verify_cert=="boolean"?e.verify_cert:t.verify_cert,verify_hostname:typeof e.verify_hostname=="boolean"?e.verify_hostname:t.verify_hostname,connect_timeout_ms:Ne(e.connect_timeout_ms),total_connect_timeout_ms:Ne(e.total_connect_timeout_ms),read_timeout_ms:Ne(e.read_timeout_ms),write_timeout_ms:Ne(e.write_timeout_ms),idle_timeout_ms:Ne(e.idle_timeout_ms)}},Cs=(e,t)=>{const l=ft(t+1),s=Array.isArray(e.upstreams)&&e.upstreams.length>0?e.upstreams:Array.isArray(e.upstream)&&e.upstream.length>0?e.upstream:[it()];return{...l,...e,name:String(e.name??l.name),host:e.host==null?"":String(e.host),path_prefix:String(e.path_prefix??l.path_prefix),is_default:e.is_default??l.is_default,lb:xs(e.lb),max_retries:Ne(e.max_retries)??l.max_retries,retry_backoff_ms:Ne(e.retry_backoff_ms)??l.retry_backoff_ms,circuit_breaker:{...Gt(),...e.circuit_breaker??{}},upstreams:s.map(Ss)}},Xt=e=>{var s,r,a,o,f,d,c,_,b,h,w,g;const t=Kt(),l=Array.isArray(e.routes)&&e.routes.length>0?e.routes:Array.isArray(e.route)&&e.route.length>0?e.route:t.routes;return{server:{...t.server,...e.server??{},listen:Array.isArray((s=e.server)==null?void 0:s.listen)&&e.server.listen.length>0?e.server.listen.map(x=>String(x).trim()).filter(Boolean):t.server.listen,health_path:String(((r=e.server)==null?void 0:r.health_path)??t.server.health_path),ready_path:String(((a=e.server)==null?void 0:a.ready_path)??t.server.ready_path),threads:Ne((o=e.server)==null?void 0:o.threads),grace_period_seconds:Ne((f=e.server)==null?void 0:f.grace_period_seconds),graceful_shutdown_timeout_seconds:Ne((d=e.server)==null?void 0:d.graceful_shutdown_timeout_seconds),config_reload_debounce_ms:Ne((c=e.server)==null?void 0:c.config_reload_debounce_ms)??t.server.config_reload_debounce_ms,tls:((_=e.server)==null?void 0:_.tls)===null?null:(b=e.server)!=null&&b.tls?{listen:String(e.server.tls.listen??"0.0.0.0:8443"),cert_path:String(e.server.tls.cert_path??""),key_path:String(e.server.tls.key_path??""),enable_h2:e.server.tls.enable_h2??!0}:t.server.tls},observability:{...t.observability,...e.observability??{},log_level:String(((h=e.observability)==null?void 0:h.log_level)??t.observability.log_level),access_log:((w=e.observability)==null?void 0:w.access_log)??t.observability.access_log,prometheus_listen:((g=e.observability)==null?void 0:g.prometheus_listen)==null?"":String(e.observability.prometheus_listen)},routes:l.map(Cs)}},Yt="/web/config",Ts="/web/health/routes",Zt=1e4,vt=async(e,t,l=Zt)=>{const s=new AbortController,r=window.setTimeout(()=>s.abort(),l);try{return await fetch(e,{...t,signal:s.signal})}finally{window.clearTimeout(r)}},$t=async(e,t)=>{const s=(await t.text()).trim()||t.statusText||"unknown_error";return new Error(`${e} failed (${t.status}): ${s}`)},Is=async()=>{const e=await vt(`${Yt}?format=json`,{method:"GET",headers:{Accept:"application/json"},cache:"no-store"});if(!e.ok)throw await $t("load_config",e);const t=await e.json();return Xt(t)},Es=async e=>{const t=await vt(Yt,{method:"PUT",headers:{"Content-Type":"text/plain; charset=utf-8"},body:e}),l=(await t.text()).trim();if(!t.ok){const s=l||t.statusText||"unknown_error";throw new Error(`save_config failed (${t.status}): ${s}`)}return l||"config_applied"},Rs=async(e=1200,t)=>{const l=new URLSearchParams({timeout_ms:String(Math.max(100,Math.min(1e4,Math.floor(e))))}),s=t&&t.trim().length>0?"POST":"GET",r=await vt(`${Ts}?${l.toString()}`,{method:s,headers:{Accept:"application/json",...s==="POST"?{"Content-Type":"text/plain; charset=utf-8"}:{}},cache:"no-store",...s==="POST"?{body:t}:{}},Zt+e);if(!r.ok)throw await $t("load_route_health",r);return await r.json()};function As(e){let t,l,s,r,a,o,f,d,c,_,b,h,w,g,x,v;return l=new ml({props:{saveDisabled:e[10]||e[9]||e[17].length>0,reloadDisabled:e[10]||e[9],saving:e[10],loading:e[9],statusMessage:e[11],statusTone:e[12],lastSynced:e[13]}}),l.$on("saveToServer",e[20]),l.$on("reloadFromServer",e[18]),l.$on("exportJson",e[21]),l.$on("importJson",e[22]),o=new vs({props:{server:e[3].server}}),o.$on("save",e[23]),d=new Il({props:{observability:e[3].observability}}),d.$on("change",e[24]),b=new Yl({props:{routeQuery:e[1],rows:e[14],selectedRouteIndex:e[0],routeHealthByIndex:e[7],healthLoading:e[2],healthError:e[8]}}),b.$on("addRoute",e[27]),b.$on("refreshHealth",e[31]),b.$on("search",e[32]),b.$on("view",e[33]),b.$on("edit",e[34]),b.$on("delete",e[35]),w=new Ql({props:{route:e[16],routeIndex:e[15],mode:e[6]}}),w.$on("close",e[29]),x=new ws({props:{toml:e[4],issues:e[17],copied:e[5]}}),x.$on("copy",e[25]),{c(){t=u("main"),Ye(l.$$.fragment),s=y(),r=u("div"),a=u("div"),Ye(o.$$.fragment),f=y(),Ye(d.$$.fragment),c=y(),_=u("div"),Ye(b.$$.fragment),h=y(),Ye(w.$$.fragment),g=y(),Ye(x.$$.fragment),i(a,"class","grid gap-4 lg:grid-cols-2"),i(_,"class","grid gap-4 xl:grid-cols-2"),i(r,"class","mt-4 space-y-4"),i(t,"class","min-h-screen w-full px-3 py-3 text-ink md:px-5")},m(p,C){U(p,t,C),ze(l,t,null),n(t,s),n(t,r),n(r,a),ze(o,a,null),n(a,f),ze(d,a,null),n(r,c),n(r,_),ze(b,_,null),n(_,h),ze(w,_,null),n(r,g),ze(x,r,null),v=!0},p(p,C){const k={};C[0]&132608&&(k.saveDisabled=p[10]||p[9]||p[17].length>0),C[0]&1536&&(k.reloadDisabled=p[10]||p[9]),C[0]&1024&&(k.saving=p[10]),C[0]&512&&(k.loading=p[9]),C[0]&2048&&(k.statusMessage=p[11]),C[0]&4096&&(k.statusTone=p[12]),C[0]&8192&&(k.lastSynced=p[13]),l.$set(k);const L={};C[0]&8&&(L.server=p[3].server),o.$set(L);const N={};C[0]&8&&(N.observability=p[3].observability),d.$set(N);const M={};C[0]&2&&(M.routeQuery=p[1]),C[0]&16384&&(M.rows=p[14]),C[0]&1&&(M.selectedRouteIndex=p[0]),C[0]&128&&(M.routeHealthByIndex=p[7]),C[0]&4&&(M.healthLoading=p[2]),C[0]&256&&(M.healthError=p[8]),b.$set(M);const A={};C[0]&65536&&(A.route=p[16]),C[0]&32768&&(A.routeIndex=p[15]),C[0]&64&&(A.mode=p[6]),w.$set(A);const O={};C[0]&16&&(O.toml=p[4]),C[0]&131072&&(O.issues=p[17]),C[0]&32&&(O.copied=p[5]),x.$set(O)},i(p){v||(Be(l.$$.fragment,p),Be(o.$$.fragment,p),Be(d.$$.fragment,p),Be(b.$$.fragment,p),Be(w.$$.fragment,p),Be(x.$$.fragment,p),v=!0)},o(p){Ve(l.$$.fragment,p),Ve(o.$$.fragment,p),Ve(d.$$.fragment,p),Ve(b.$$.fragment,p),Ve(w.$$.fragment,p),Ve(x.$$.fragment,p),v=!1},d(p){p&&H(t),Je(l),Je(o),Je(d),Je(b),Je(w),Je(x)}}}function Ls(e,t,l){let s,r,a,o,f,d;pt(e,Ie,R=>l(3,o=R)),pt(e,Nl,R=>l(4,f=R)),pt(e,Ol,R=>l(17,d=R));let c=!1,_="view",b=null,h="",w={},g="",x=!1,v="",p=!1,C=!1,k="Ready",L="neutral",N="";const M=()=>new Intl.DateTimeFormat(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date),A=R=>R instanceof Error?R.message:String(R),O=(R,V="neutral")=>{l(11,k=R),l(12,L=V)},F=()=>{l(7,w={}),l(30,g=""),l(8,v="")},T=async()=>{if(p||C)return;l(9,p=!0);let R=!1;O("Loading config from admin API...");try{const V=await Is();Ie.set(V),F(),b!==null&&b>=V.routes.length&&l(0,b=null),l(13,N=M()),O("Loaded config from admin API.","ok"),R=!0}catch(V){O(`Load failed: ${A(V)}`,"error")}finally{l(9,p=!1),R&&j()}},j=async()=>{if(x||p)return;const R=f;l(2,x=!0),l(8,v="");try{const V=await Rs(1200,R),oe={};V.routes.forEach(le=>{oe[le.route_index]=le}),l(7,w=oe),l(30,g=R)}catch(V){l(8,v=A(V)),O(`Route health check failed: ${v}`,"error")}finally{l(2,x=!1)}},z=async()=>{if(!(C||p)){if(d.length>0){O(`Save blocked: validation failed (${d.length} issue(s)).`,"error");return}l(10,C=!0),O("Saving config to admin API...");try{const R=await Es(f);l(13,N=M()),O(`Save successful: ${R}`,"ok"),j()}catch(R){O(`Save failed: ${A(R)}`,"error")}finally{l(10,C=!1)}}},re=R=>{Ie.update(V=>(V.server=R,V))},W=(R,V)=>{Ie.update(oe=>(oe.observability[R]=V,oe))},ce=()=>{const R=JSON.stringify(o,null,2),V=new Blob([R],{type:"application/json"}),oe=URL.createObjectURL(V),le=document.createElement("a");le.href=oe,le.download="prx-config.json",le.click(),URL.revokeObjectURL(oe)},ue=async R=>{const V=R.currentTarget;if(!(!V.files||V.files.length===0))try{const le=await V.files[0].text(),Re=JSON.parse(le);Ie.set(Xt(Re)),F(),O("Imported JSON locally. Click Save to Server to apply.","neutral")}catch(oe){O(`Import failed: ${A(oe)}`,"error")}finally{V.value=""}},K=R=>{ue(R.detail)},Y=R=>{re(R.detail)},ae=R=>{const{key:V,value:oe}=R.detail;if(V==="access_log"){W("access_log",!!oe);return}if(V==="log_level"){W("log_level",String(oe));return}W("prometheus_listen",String(oe))},ee=async()=>{await navigator.clipboard.writeText(f),l(5,c=!0),setTimeout(()=>{l(5,c=!1)},1800)},q=(R,V)=>{l(0,b=R),l(6,_=V)},$=()=>{jl(),F(),l(0,b=o.routes.length-1),l(6,_="edit")},m=R=>{if(confirm("Delete this route?")){if(Dl(R),F(),o.routes.length===0){l(0,b=null);return}if(b===R){l(0,b=null);return}b!==null&&b>R&&l(0,b-=1)}},I=()=>{l(0,b=null)};rl(()=>{T()});const J=()=>void j(),ie=R=>l(1,h=R.detail),be=R=>q(R.detail,"view"),te=R=>q(R.detail,"edit"),xe=R=>m(R.detail);return e.$$.update=()=>{e.$$.dirty[0]&9&&l(16,s=b===null?null:o.routes[b]??null),e.$$.dirty[0]&1&&l(15,r=b??0),e.$$.dirty[0]&1073741844&&g&&!x&&f!==g&&F(),e.$$.dirty[0]&10&&l(14,a=o.routes.map((R,V)=>({route:R,routeIndex:V})).filter(({route:R})=>{const V=h.trim().toLowerCase();return V?R.name.toLowerCase().includes(V)||R.host.toLowerCase().includes(V)||R.path_prefix.toLowerCase().includes(V)||R.lb.toLowerCase().includes(V):!0}))},[b,h,x,o,f,c,_,w,v,p,C,k,L,N,a,r,s,d,T,j,z,ce,K,Y,ae,ee,q,$,m,I,g,J,ie,be,te,xe]}class Ms extends Ke{constructor(t){super(),Ge(this,t,Ls,As,qe,{},null,[-1,-1])}}new Ms({target:document.getElementById("app")});
